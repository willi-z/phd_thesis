\chapter{\label{sec:sim_sbe}Skalenübergreifende Charakterisierung zweiphasiger Elektrolyte}

Die numerische Beschreibung zweiphasiger Elektrolytsysteme erfordert aufgrund ihrer komplexen Porenmorphologie eine effiziente Reduktion der Mikrostrukturkomplexität unter Wahrung der physikalischen Genauigkeit (\textbf{TZ 2}). Die hier entwickelte Methodik kombiniert unterschiedliche Modellierungsansätze, um den Rechenaufwand konventioneller Feldsimulationen zu umgehen. Zunächst ermöglicht eine Porennetzwerk-Modellierung die hocheffiziente Bestimmung der ionischen Leitfähigkeit $\gamma$ und des effektiven Diffusionskoeffizienten $D$ direkt aus experimentellen Absorptionsmessungen. Während dieser Ansatz eine schnelle Charakterisierung der Transporteigenschaften erlaubt, bleibt die mechanische Steifigkeit $\boldsymbol{C}$ unberücksichtigt. 

Um diese Lücke zu schließen, wird die \textit{Walk-on-Spheres}-Methode eingesetzt, die sowohl Diffusionskoeffizienten als auch effektive Steifigkeiten in komplexen, nicht-templatebasierten Porenstrukturen simultan berechnen kann. Da dieses Verfahren jedoch auf eine präzise räumliche Geometrie angewiesen ist, wird die Methodik durch ein \textit{Convolutional Neural Network} (CNN) vervollständigt. Dieses sagt die Parameter der Cahn-Hilliard-Gleichung direkt aus REM-Aufnahmen voraus und automatisiert so die Generierung realistischer Repräsentativer Volumenelemente (RVE). In der Summe entsteht eine geschlossene Simulationskette, die von der Bilddiagnostik bis zur Vorhersage makroskopischer Materialparameter eine recheneffiziente Skalierung gewährleistet.


\section{Modellierung der effektiven Ionenleitfähigkeit als Porennetzwerk}

Die Porennetzwerk-Modellierung (PNM) ist ein ursprünglich aus den Geowissenschaften stammendes Ersatzmodell, welches in dieser Arbeit für die Anwendung auf zweiphasige Elektrolyte adaptiert wurde \cite{Xiong2016, Gostick2016}. Hierbei wird die Prämisse zugrunde gelegt, dass der Ionentransport ausschließlich in der flüssigen Phase stattfindet, während das feste Polymernetzwerk als isolierend betrachtet wird \cite{Tu2020}.

\begin{figure}[!ht]
    \center
    \includegraphics[width=0.99\textwidth, angle=0]{sphere_cylinder_model.pdf}
    \caption{\label{fig:sphere_cylinder_model}Porennetzwerkmodell mit sphärischen Poren und zylindrischen Verbindungselementen zur recheneffizienten Bestimmung der effektiven Transporteigenschaften zweiphasiger Strukturelektrolyte.}
\end{figure}

Die Grundlage bildet die Beschreibung des diffusiven Transports. Das erste Ficksche Gesetz beschreibt den molaren Ionenfluss $\boldsymbol{j}$ in Abhängigkeit des Konzentrationsgradienten:
\begin{equation}\label{eq:fick_local}
    \boldsymbol{j} = -D \nabla c.
\end{equation}
Durch Integration über die Querschnittsfläche $A$ ergibt sich die molare Flussrate $\dot{m}$:
\begin{equation}
    \dot{m} = -D \cdot A(x) \frac{\partial c}{\partial x}.
\end{equation}
Aus der Massenbilanz für jede Pore $i$ und deren benachbarte Poren $j \in \text{Nb}_i$\footnote{$\text{Nb}$ is die Anzahl an Nachbarporen der Pore $i$.} folgt im stationären Zustand:
\begin{equation}
    \sum_{j \in \text{Nb}_i} \dot{m}_{ij} = \sum_{j \in \text{Nb}_i} D \cdot S_{ij} (c_i - c_j) = 0.
\end{equation}
Dabei repräsentiert $S_{ij}$ den geometrischen Formfaktor, welcher sich aus den Widerständen der Poren $S^p$ und des Verbindungskanals $S^v$ zusammensetzt:
\begin{equation}
    \frac{1}{S_{ij}} = \frac{1}{S^p_i} + \frac{1}{S^v_{ij}} + \frac{1}{S^p_j}.
\end{equation}
Unter Annahme kugelformiger Poren mit Durchmesser $d$ und zylindrischer Verbindungen mit Durchmesser $d_{ij}$ und Länge $l$ ergeben sich die Formfaktoren zu:
\begin{align}
    S^p_i &= \frac{\pi (3d_i^2 - 4l_{ij,i}^2)}{12l_{ij,i}}, \\
    S^p_j &= \frac{\pi (3d_j^2 - 4l_{ij,j}^2)}{12l_{ij,j}}, \\
    S^v_{ij} &= \frac{\pi d_{ij}^2}{4l_{ij}}.
\end{align}

Die Verknüpfung zur ionischen Leitfähigkeit $\gamma$ erfolgt über die Nernst-Einstein-Gleichung:
\begin{equation}
    D = \frac{k_{\text{B}}T}{n q^2} \gamma.
\end{equation}
Hieraus lässt sich eine modifizierte molare Flussrate $\dot{m}'$ ableiten, welche die ionischen Leitfähigkeit direkt berücksichtigt:
\begin{equation}
    \sum_{j \in \text{Nb}_i} \dot{m}'_{ij} = \sum_{j \in \text{Nb}_i} \gamma \cdot S_{ij} (U_i - U_j) = 0.
\end{equation}

Die Bestimmung der effektiven Kenngrößen erfolgt über die Bilanzierung des Gesamtsystems der Länge $L$ und Querschnittsfläche $A$:
\begin{enumerate}
    \item Effektiver Diffusionskoeffizient: $D_{\text{eff}} = \frac{\dot{m} \cdot L}{A \Delta c}$
    \item Effektive ionische Leitfähigkeit: $\gamma_{\text{eff}} = \frac{\dot{m}' \cdot L}{A \Delta U}$
    \item Tortuosität: $\tau = \psi \frac{D}{D_{\text{eff}}} = \psi \frac{\gamma}{\gamma_{\text{eff}}}$
\end{enumerate}
Die Porosität $\psi$ ist dabei als das Verhältnis des fluiden Volumens $V_f$ (Summe aus Porenvolumen $V_p$ und Verbindungsvolumen $V_v$) zum Gesamtvolumen $V_{\text{gesamt}}$ definiert:
\begin{equation}
    \psi = \frac{V_f}{V_{\text{gesamt}}} = \frac{V_p + V_v}{V_{\text{gesamt}}}.
\end{equation}

Zur Validierung der Methode wurden drei oligomere Elektrolyte\footnote{Die Ziffern O1, O2 und O4 geben den durchschnittlichen Polymerisationsgrad an, also die Anzahl der chemischen Wiederholungseinheiten. Die Herstellung erfolgt durch ringöffnende Polymerisation von Trimethylencarbonat, wobei die Kettenlänge über das Verhältnis zum Starter (1,3-Propandiol) gesteuert wird.} (O1\_50\footnote{O1 mit 50~wt\% \ce{LiTFSI}}, O2\_40\footnote{O2 mit 40~wt\% \ce{LiTFSI}}, O4\_40\footnote{O4 mit 40~wt\% \ce{LiTFSI}}) herangezogen, für welche experimentelle Daten aus Gasadsorptionsmessungen und Leitfähigkeitsuntersuchungen vorliegen \cite{Emilsson2023}. Die experimentell ermittelten Porengrößenverteilungen (Bild~\ref{fig:sphere_cylinder_model_RVE_generation}a) dienen als direkte Eingangsvariable für die stochastische Generierung der Repräsentativen Volumenelemente (RVE). Dabei wird die Verteilung normalisiert, um eine Wahrscheinlichkeitsverteilung für die Porenradien zu erhalten (Bild~\ref{fig:sphere_cylinder_model_RVE_generation}b).

\begin{figure}[!ht]
    \center
    \includegraphics[width=0.99\textwidth, angle=0]{RVE_generation.pdf}
    \caption{\label{fig:sphere_cylinder_model_RVE_generation}Prozesskette der RVE-Generierung: (a) Gasadsorptionsmessung der Oligomere O1-O4, (b) kumulative Wahrscheinlichkeitsverteilung, (c) stochastische Porenplatzierung, (d) Vernetzung und Skalierung, (e) Simulation der Transportvorgänge.}
\end{figure}

Ein kritischer Modellparameter ist das Volumenverhältnis $r$ zwischen Verbindungs- und Porenvolumen, welches die Porosität $\psi$ maßgeblich beeinflusst:
\begin{equation}
    r = \frac{V_v}{V_p} \quad \Rightarrow \quad V_f = V_p (1 + r).
\end{equation}
Die Poren werden unter Verwendung eines KD-Tree-Algorithmus kollisionsfrei und unter Einhaltung periodischer Randbedingungen im kubischen Volumen platziert (Bild~\ref{fig:sphere_cylinder_model_RVE_generation}c). Die anschließende Vernetzung der $n$ nächsten Nachbarn nutzt ein iteratives Intervallhalbierungsverfahren, um die Verbindungsradien so zu skalieren, dass das vordefinierte Volumenverhältnis $r$ exakt abgebildet wird (Bild~\ref{fig:sphere_cylinder_model_RVE_generation}d). 

Die Genauigkeit wird über den relativen Fehler $\text{Err}_{\text{rel}}$ gegenüber den experimentellen Werten $\gamma_{\text{eff,exp}}$ quantifiziert:
\begin{equation}
    \text{Err}_{\text{rel}} = \frac{\gamma_{\text{eff,PNM}} - \gamma_{\text{eff,exp}}}{\gamma_{\text{eff,PNM}}}.
\end{equation}

\begin{figure}[!ht]
    \center
    \includegraphics[width=0.8\textwidth, angle=0]{convergence.pdf}
    \caption{\label{fig:sphere_cylinder_model_convergence}Analyse des relativen Fehlers: (a) Einfluss des Volumenverhältnisses, (b) Variation der Konnektivität, (c-e) Konvergenzstudie über der Porenanzahl.}
\end{figure}

Die Ergebnisse (Bild~\ref{fig:sphere_cylinder_model_convergence}) verdeutlichen, dass der Fehler mit zunehmender Netzwerkgröße sinkt. Ab einer Anzahl von ca. 3000 Poren stabilisiert sich der Fehler unterhalb von \SI{10}{\percent}. Es zeigte sich zudem, dass die Konnektivität (Anzahl der Verbindungen pro Pore) die effektive Leitfähigkeit maßgeblich beeinflusst (Bild~\ref{fig:sphere_cylinder_model_convergence}b). 
Trotz der hohen Recheneffizienz verbleiben Herausforderungen in der experimentellen Bestimmbarkeit der Hals-zu-Poren-Verhältnisse. Zudem ist dieser Ansatz naturgemäß auf Transporteigenschaften limitiert. %Zur Bestimmung der mechanischen Steifigkeit der festen Phase sind weiterführende Methoden wie die \textit{Walk-on-Spheres}-Methode erforderlich \cite{Sawhney2023a}.

\section{Effektive mechanische und diffusive Eigenschaften mittels Walk-on-Stars}

Die \textit{Walk-on-Stars}-Methode (WoSt) ist ein netzfreies Verfahren zur Lösung linearer Differentialgleichungen, das sich aufgrund seiner inhärenten Parallelisierbarkeit besonders für die Implementierung auf Grafikkarten (GPUs) eignet. Im Gegensatz zu klassischen Feldmethoden ermöglicht WoSt die effiziente Behandlung fraktaler Geometrien mit hohen Detailgraden \cite{Sawhney2023a}. Die mathematische Grundlage bilden die Arbeiten von \textsc{Feynman} und \textsc{Kac}, welche den Zusammenhang zwischen parabolischen partiellen Differentialgleichungen und stochastischen Prozessen aufzeigten \cite{Pascucci2024}.

WoSt stellt eine Weiterentwicklung der \textit{Walk-on-Spheres}-Methode (WoS) dar, bei der die Brownsche Molekularbewegung durch Zufallsbewegungen innerhalb von maximalen Sterngebieten anstatt einfacher Kugeln approximiert wird (Bild~\ref{fig:wost_method}a-f) \cite{Sawhney2020}. Das Verfahren basiert auf drei Kernmechanismen: der Bestimmung des größtmöglichen Sterngebietes für jeden Abfragepunkt, der Reflexion von Pfaden an Neumann-Randbedingungen\footnote{Die Neumann-Randbedingung (auch Randbedingung 2. Art) definiert die Normalenableitung der Funktion am Rand, was physikalisch meist einem Fluss entspricht: $\frac{\partial u}{\partial \mathbf{n}}(\mathbf{x}) = \nabla u \cdot \mathbf{n} = g(\mathbf{x}) \quad \forall \mathbf{x} \in \partial \Omega$, wobei $\mathbf{n}$ den äußeren Normalenvektor beschreibt.} und der Aggregation der Pfade beim Auftreffen auf Dirichlet-Randbedingungen\footnote{Die Dirichlet-Randbedingung (auch Randbedingung 1. Art) legt den Wert der gesuchten Funktion $u$ direkt auf dem Rand $\partial \Omega$ des Definitionsbereiches fest: $u(\mathbf{x}) = f(\mathbf{x}) \quad \forall \mathbf{x} \in \partial \Omega$.} oder nach Erreichen eines Abbruchkriteriums \cite{Sawhney2023a}.

\begin{figure}[!ht]
    \center
    \includegraphics[width=0.99\textwidth, angle=0]{wost_method.pdf}
    \caption{\label{fig:wost_method} (a) Brownsche Bewegung mit absorbierenden (Dirichlet) und reflektierenden (Neumann) Rändern. (b--f) Ablauf der WoSt-Methode zur Punkt-Approximation. (e) Berücksichtigung heterogener Materialkoeffizienten durch lokale Abtastung.}
\end{figure}

Die Methode erlaubt bei bekannter Geometrie eine simultane Bestimmung der effektiven Steifigkeit $\boldsymbol{C}$ der festen Phase sowie des effektiven Diffusionskoeffizienten $D_{\text{eff}}$ der flüssigen Phase. Zur Approximation der Verschiebung $\boldsymbol{u}$ an der Stelle $\boldsymbol{x}$ innerhalb der festen Phase wird der elastische Greensche Tensor $\boldsymbol{G}(\boldsymbol{x}, \boldsymbol{y})$ genutzt:
\begin{equation}
    \boldsymbol{u}(\boldsymbol{x}) = \mathbb{E} \left[ \int_{0}^{\tau} \boldsymbol{G}(\boldsymbol{x},\boldsymbol{X}_t) \boldsymbol{f}(\boldsymbol{X}_t) \text{d}t + \boldsymbol{G}(\boldsymbol{x},\boldsymbol{X}_{\tau}) \boldsymbol{g}(\boldsymbol{X}_{\tau}) \right].
\end{equation}
Dabei ist $\tau$ die Zeit bis zum Erreichen der Dirichlet-Randbedingung $\boldsymbol{g}$. Für isotrope Medien ist $\boldsymbol{G}(\boldsymbol{x}, \boldsymbol{y})$ definiert als \cite{Lazar2014, Chen2022b}:
\begin{equation}
    \boldsymbol{G}(\boldsymbol{x}, \boldsymbol{y}) = \frac{1}{4\pi G r} \begin{bmatrix}
        1-\frac {1}{2b}+\frac {1}{2b}\frac {x^2}{r^2} & {\frac {1}{2b}}{\frac {xy}{r^{2}}} & {\frac {1}{2b}}{\frac {xz}{r^{2}}}\\
        {\frac {1}{2b}}{\frac {yx}{r^{2}}} & 1-{\frac {1}{2b}}+{\frac {1}{2b}}{\frac {y^{2}}{r^{2}}} & {\frac {1}{2b}}{\frac {yz}{r^{2}}}\\
        {\frac {1}{2b}}{\frac {zx}{r^{2}}} & {\frac {1}{2b}}{\frac {zy}{r^{2}}} & 1-{\frac {1}{2b}}+{\frac {1}{2b}}{\frac {z^{2}}{r^{2}}}
    \end{bmatrix}
\end{equation}
mit dem Abstandsvektor $\boldsymbol{r} = \boldsymbol{x} - \boldsymbol{y}$, $r = \lVert \boldsymbol{r} \rVert$, $b = 2(1-\nu)$ und dem Schubmodul $G = E / (2(1+\nu))$.

Unter der Annahme eines kraftfreien Körpers ($\boldsymbol{f}=\boldsymbol{0}$) und homogener Materialeigenschaften wird die Verschiebung durch Mittelung über $N$ stochastische Pfade mit jeweils $K_i$ Schritten approximiert \cite{Chen2024b}:
\begin{equation}
    \boldsymbol{u}(\boldsymbol{x}) \approx \frac{1}{N} \sum_{i=1}^{N} \sum_{k=1}^{K_i} \boldsymbol{G}(\boldsymbol{x}, \boldsymbol{X}_{i,k}) w_{i,k}.
\end{equation}
Für die Gewichtung $w_{k}$ gilt an Neumann-Flächen die Traktion $w_{k,N} = \boldsymbol{\sigma} \boldsymbol{n} = \boldsymbol{t}$ und an Dirichlet-Rändern die vorgegebene Verschiebung $w_{k,D} = \boldsymbol{u}$.

Zur Bestimmung der effektiven Steifigkeit des RVE wird ein kubisches Gebiet $\Omega = [0,L]^3$ mit einer Dirichlet-Bedingung am unteren Rand ($\boldsymbol{u}(x,y,0) = \boldsymbol{0}$) und einer Neumann-Bedingung am oberen Rand ($\boldsymbol{\sigma} \boldsymbol{n} = -p \boldsymbol{e}_z$) definiert. Die über WoSt approximierte mittlere Verschiebung $u_z$ an der Oberseite erlaubt die direkte Berechnung des effektiven Elastizitätsmoduls:
\begin{equation}
    E_{\text{eff}} = \frac{\Delta \sigma}{\Delta \varepsilon} = \frac{p \cdot L}{u_z(z=L)}.
\end{equation}

\begin{figure}[!ht]
    \center
    \includegraphics[width=0.99\textwidth, angle=0]{wost_results.pdf}
    \caption{\label{fig:wost_result} (a) WoSt-Simulation der Diffusion. (b) Simulation der mechanischen Verformung. (c--d) Konvergenzanalyse der Fehler für Diffusion und Steifigkeit in Abhängigkeit der Stichprobengröße.}
\end{figure}

Analog wird das Verfahren in der flüssigen Phase angewendet, um den effektiven Diffusionskoeffizienten $D_{\text{eff}}$ über die stochastische Pfadaggregation zu bestimmen.



\section{CNN-basierte RVE-Generierung aus REM-Aufnahmen}

Sowohl die Porennetzwerkmethode als auch der \textit{Walk-on-Stars}-Ansatz erfordern eine präzise geometrische Repräsentation der zweiphasigen Strukturelektrolyte. Während die Generierung aus Gasadsorptionsmessungen ein effektives Ersatzmodell liefert, sind diese Daten in der Literatur nicht durchgehend verfügbar. Als leistungsfähige Alternative können Rasterelektronenmikroskop-Aufnahmen (REM) genutzt werden, um mittels maschinellen Lernens (ML) die Parameter der \textsc{Cahn-Hilliard}-Gleichung sowie die Simulationsdauer $T_{\text{end}}$ zu bestimmen.

\begin{figure}[!ht]
    \center
    \includegraphics[width=0.99\textwidth, angle=0]{nn_metod_rve_se.pdf}
    \caption{\label{fig:nn_method_rve_se}Einsatz eines \textit{Convolutional Neural Networks} (CNN) zur Extraktion struktureller Merkmale und anschließender Vorhersage der \textsc{Cahn-Hilliard}-Parameter.}
\end{figure}

Der Trainingsdatensatz umfasst Grauwert-REM-Scans, die realen Abmessungen der Bildausschnitte sowie experimentell\footnote{Die experimentellen Daten und REM-Aufnahmen wurden im Kontext des ElViS-Projektes von den beiden Projektpartners IWS und Tu Dresden erhoben.} bestimmte Referenzwerte für die effektive Steifigkeit $E_{\text{eff}}$ und den Diffusionskoeffizienten $D_{\text{eff}}$. Ein CNN extrahiert hierbei texturrelevante Merkmale, die zusammen mit den geometrischen Randbedingungen an ein \textit{Fully Connected Network} übergeben werden. Dieses sagt die physikalischen Parameter für die Gefügesimulation voraus, insbesondere die Mobilität $M$ und den Gradientenenergiekoeffizienten $\lambda$ (Bild~\ref{fig:nn_method_rve_se}).

Zur Validierung und Berechnung der Verlustfunktion wird die \textsc{Cahn-Hilliard}-Gleichung mittels der FE-Methode gelöst\footnote{Die numerische Umsetzung erfolgte in \texttt{FEniCSx} unter Verwendung regelmäßiger Blockelemente wegen der guten Parallelisierungunterstützung.}. Aus der resultierenden zeitabhängigen Lösung des Phasenanteils $\varphi(\boldsymbol{x}, t)$ werden zum Zeitpunkt $t^*$ mittels \textit{Marching Cubes} die Phasengrenzen als Isoflächen extrahiert. Auf dieser generierten Geometrie wird unmittelbar eine linear-elastische FEM-Analyse sowie die Lösung der Diffusionsgleichung durchgeführt, um die simulierten Kennwerte mit den experimentellen Daten abzugleichen:
\begin{equation}
    \nabla \cdot \bigl(\boldsymbol{C} : \boldsymbol{\varepsilon}\bigr) = \mathbf{0}.
\end{equation}

\begin{figure}[!ht]
    \center
    \includegraphics[width=0.6\textwidth, angle=0]{training_progress.pdf}
    \caption{\label{fig:nn_method_result}Konvergenz der Verlustfunktion $\mathcal{L}$ während des Trainingsprozesses.}
\end{figure}

Das Modell wird \textit{end-to-end} trainiert, indem die Abweichung der simulierten von den experimentellen Werten in die Verlustfunktion $\mathcal{L}$ einfließt:
\begin{equation}
    \mathcal{L} = \left( 1 + \sqrt{ \left\lVert \frac{E_{\text{eff}}^{\text{pred}} - E_{\text{eff}}^{\text{exp}}}{E_{\text{rein}}^{\text{exp}}} \right\rVert^2 + \left\lVert \frac{D_{\text{eff}}^{\text{pred}} - D_{\text{eff}}^{\text{exp}}}{D_{\text{rein}}^{\text{exp}}} \right\rVert^2 } \right)^{-1}.
\end{equation}

\input{Abbildungen/03_Modellierung/generated_rve_se/generated_rve_se.tex}

Die Ergebnisse (Tabelle~\ref{tab:nn_method_rve_se_results}) zeigen, dass das Netzwerk die Parameter konsistent ableitet. Hohe $\mathcal{L}$-Werte zwischen 0,88 und 0,98 belegen eine exzellente Übereinstimmung mit den Experimenten. Die Parameter $M$\footnote{Die Mobilität ist im Kontext der Cahn-Hilliard-Gleichung ein Maß für die Geschwindigkeit der Phasenseparation.} und $T_{\text{end}}$\footnote{Zeitpunkt, bei dem die fortlaufende Phasenseparation gestopped wird.} korrelieren hierbei stark mit der Koarsening-Dynamik: Eine hohe Mobilität führt zu einer schnelleren Ausbildung großer Porenstrukturen, wie beim System 50MTM57/2.3 beobachtet. 

Der Startwert $\varphi_0$ definiert das initiale Phasenverhältnis, wobei niedrigere Werte (z.B. polyMIPE) einen höheren Festphasenanteil repräsentieren. Der Koeffizient $\lambda$ bestimmt die Schärfe der Phasengrenzen; größere Werte führen zu klarer ausgeprägten Strukturen, was qualitativ mit den REM-Aufnahmen übereinstimmt. Damit stellt die ML-basierte Parametrisierung eine robuste Methode dar, um experimentell schwer zugängliche Gefügeparameter direkt aus der Bildgebung in physikalisch konsistente RVE-Modelle zu überführen.
